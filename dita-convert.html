<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DITA to HTML/PDF Converter</title>

<!-- html2pdf library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        max-width: 900px;
        margin: auto;
    }

    h1 {
        font-size: 2em;
    }

    /* Print/PDF-specific styles */
    @media print {
        body {
            font-size: 12px;
        }
        h1 {
            font-size: 18px;
        }
    }
</style>
</head>
<body>

<h1>DITA to HTML/PDF Converter</h1>

<input type="file" id="fileInput" accept=".xml">
<button id="downloadHTML">Download HTML</button>
<button id="downloadPDF">Download PDF</button>

<div id="output" style="margin-top:20px; border:1px solid #ccc; padding:10px;">
    <em>Your converted content will appear here...</em>
</div>

<script>
document.getElementById('fileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(e.target.result, "text/xml");

        // Simple XML to HTML conversion (modify for your DITA)
        let htmlContent = "<h1>" + xmlDoc.getElementsByTagName("title")[0]?.textContent + "</h1>";
        const sections = xmlDoc.getElementsByTagName("p");
        for (let i = 0; i < sections.length; i++) {
            htmlContent += "<p>" + sections[i].textContent + "</p>";
        }

        document.getElementById('output').innerHTML = htmlContent;

        // Store filename for later
        document.getElementById('output').dataset.filename = file.name.replace(/\.[^/.]+$/, "");
    };
    reader.readAsText(file);
});

document.getElementById('downloadHTML').addEventListener('click', function() {
    const content = document.getElementById('output').innerHTML;
    const blob = new Blob([content], { type: 'text/html' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = (document.getElementById('output').dataset.filename || 'output') + ".html";
    link.click();
});

document.getElementById('downloadPDF').addEventListener('click', function() {
    const element = document.getElementById('output');
    const filename = (element.dataset.filename || 'output') + ".pdf";

    html2pdf().set({
        margin: 10,
        filename: filename,
        html2canvas: { scale: 1.5 }, // lower scale â†’ smaller text
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    }).from(element).save();
});
</script>

</body>
</html>
